<div class="language-switcher relative">
    <button (click)="toggleDropdown()" type="button"
        class="flex items-center justify-center w-10 h-10 rounded-md bg-[var(--c-bg-muted)] border border-[var(--c-border-subtle)] hover:bg-[var(--c-bg-surface)] hover:border-[var(--color-primary)]/30 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2"
        [attr.aria-label]="'language.select' | transloco" [attr.aria-expanded]="isOpen()">
        <span class="fi fi-{{ currentLanguageFlag() }} rounded-sm text-lg"></span>
    </button>

    @if (isOpen()) {
    <div
        class="dropdown absolute right-0 mt-2 w-56 bg-[var(--c-bg-surface)] border border-[var(--c-border-subtle)] rounded-lg shadow-lg z-50 overflow-hidden">
        @for (lang of availableLanguages; track lang.code) {
        <button (click)="selectLanguage(lang.code)" type="button"
            class="w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-[var(--c-bg-muted)] transition-colors"
            [class.bg-[var(--c-bg-muted)]="languageService.uiLanguage() === lang.code">
            <span class="fi fi-{{ lang.flag }} text-xl"></span>
            <div class="flex flex-col">
                <span class="text-[var(--c-text-heading)] font-medium">{{ lang.displayName }}</span>
                <span class="text-[var(--c-text-muted)] text-sm">{{ lang.nativeName }}</span>
            </div>
            @if (languageService.uiLanguage() === lang.code) {
            <i class="fas fa-check ml-auto text-purple-600"></i>
            }
        </button>
        }
    </div>
    }
</div>