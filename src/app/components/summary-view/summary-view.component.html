<div class="min-h-[400px] flex flex-col justify-center items-center text-center animate-fade-in relative z-10">
    @if (isSessionSuccessful()) {
        <i class="fa-solid fa-trophy text-7xl text-amber-400"></i>
        <h2 class="text-4xl font-bold text-slate-800 mt-4">Congratulations!</h2>
        <p class="text-lg text-slate-600 mt-2">You've completed the scenario. Great work!</p>
    } @else {
        <i class="fa-solid fa-person-running text-7xl text-sky-400"></i>
        <h2 class="text-4xl font-bold text-slate-800 mt-4">Keep Practicing!</h2>
        <p class="text-lg text-slate-600 mt-2">You're on the right track. Every attempt is progress!</p>
    }

    <div class="flex gap-8 mt-8">
        <div class="text-center">
            <p class="text-slate-500">Avg. Pronunciation</p>
            <p class="text-4xl font-bold text-sky-600">{{ averagePronunciationScore() }}<span class="text-2xl text-slate-400">/100</span></p>
        </div>
         <div class="text-center">
            <p class="text-slate-500">Avg. Fluency</p>
            <p class="text-4xl font-bold text-teal-600">{{ averageFluencyScore() }}<span class="text-2xl text-slate-400">/100</span></p>
        </div>
    </div>

    <div class="w-full max-w-2xl mt-8">
        <h3 class="text-xl font-semibold text-slate-700 mb-4">Sentence Summary</h3>
        <div class="space-y-2 max-h-60 overflow-y-auto bg-slate-50 p-3 rounded-lg border">
            @for(sentence of scenario().sentences; track sentence.id) {
                @if(sentenceAssessments().has(sentence.id)) {
                    @let assessment = sentenceAssessments().get(sentence.id)!;
                    <div class="flex items-center justify-between text-left p-2 bg-white rounded shadow-sm">
                        <p class="text-sm text-slate-700 flex-1 mr-4">"{{ sentence.target.text.length > 50 ? sentence.target.text.substring(0, 50) + '...' : sentence.target.text }}"</p>
                        <div class="flex items-center gap-4">
                            <span class="text-sm font-semibold text-sky-600 w-24 text-center">
                                <i class="fa-solid fa-microphone-lines text-xs mr-1"></i>
                                {{ assessment.pronunciation_score }}%
                            </span>
                            <span class="text-sm font-semibold text-teal-600 w-24 text-center">
                                <i class="fa-solid fa-wave-square text-xs mr-1"></i>
                                {{ assessment.fluency_score }}%
                            </span>
                        </div>
                    </div>
                } @else {
                     <div class="flex items-center justify-between text-left p-2 bg-white rounded shadow-sm opacity-60">
                        <p class="text-sm text-slate-500 flex-1 mr-4">"{{ sentence.target.text.length > 50 ? sentence.target.text.substring(0, 50) + '...' : sentence.target.text }}"</p>
                        <span class="text-sm font-semibold text-slate-500">Not practiced</span>
                    </div>
                }
            }
        </div>
    </div>

    <div class="mt-8 pt-6 border-t border-slate-200 w-full max-w-2xl flex justify-center">
        <button (click)="back.emit()" class="bg-sky-500 text-white font-semibold py-3 px-8 rounded-lg hover:bg-sky-600 transition-colors">
            Back to Scenarios
        </button>
    </div>
</div>
