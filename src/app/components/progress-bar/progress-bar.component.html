<div class="w-full py-6 sm:py-8" role="navigation" aria-label="Conversation Steps">
  <div class="relative w-full max-w-6xl mx-auto px-6 sm:px-8">
    <!-- Base line with subtle gradient -->
    <div
      class="absolute inset-x-0 top-8 h-1 bg-gradient-to-r from-slate-100 via-slate-200 to-slate-100 dark:from-slate-800 dark:via-slate-700 dark:to-slate-800 rounded-full -z-10 shadow-inner">
    </div>

    <!-- Progress fill with glow effect -->
    <div
      class="absolute left-0 top-8 h-1 bg-gradient-to-r from-primary-500 via-lilac-500 to-primary-600 rounded-full transition-all duration-700 ease-out shadow-lg"
      [style.width]="progressPercent() + '%'" style="filter: drop-shadow(0 0 8px rgba(168, 85, 247, 0.4))">
    </div>

    <!-- Steps -->
    <div class="flex justify-between items-center relative">
      @for (step of steps; track step; let i = $index) {
      <div class="flex flex-col items-center text-center group cursor-pointer"
        [attr.aria-current]="isActive(i) ? 'step' : null" (click)="onStepClick(step)"
        (keydown.enter)="onStepClick(step)" (keydown.space)="onStepClick(step)" role="button"
        [attr.aria-label]="'Navigate to ' + step + ' step'">

        <!-- Active Step -->
        @if (isActive(i)) {
        <div
          class="relative flex items-center justify-center rounded-full w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-primary-600 via-lilac-600 to-primary-700 ring-4 ring-primary-300 dark:ring-primary-400 scale-110 shadow-2xl transition-all duration-500 ease-out"
          tabindex="0">
          <div class="absolute inset-0 rounded-full bg-gradient-to-br from-primary-400 to-lilac-400 opacity-30 blur-xl">
          </div>
          <i class="relative text-lg sm:text-xl text-white drop-shadow-md" [ngClass]="getIcon(step)"></i>
        </div>
        <p
          class="mt-3 text-xs sm:text-sm font-bold tracking-wide text-lilac-600 dark:text-lilac-400 transition-all duration-300 max-w-[80px] sm:max-w-none">
          {{ step }}
        </p>
        }

        <!-- Completed Step -->
        @if (isCompleted(i)) {
        <div
          class="relative flex items-center justify-center rounded-full w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-emerald-500 to-emerald-600 ring-4 ring-emerald-300 dark:ring-emerald-400 shadow-lg transition-all duration-500 ease-out group-hover:scale-110"
          tabindex="0">
          <i class="relative text-lg sm:text-xl text-white" [ngClass]="getIcon(step)"></i>
        </div>
        <p
          class="mt-3 text-xs sm:text-sm font-semibold text-emerald-700 dark:text-emerald-300 transition-all duration-300 max-w-[80px] sm:max-w-none">
          {{ step }}
        </p>
        }

        <!-- Upcoming Step -->
        @if (isUpcoming(i)) {
        <div
          class="relative flex items-center justify-center rounded-full w-12 h-12 sm:w-14 sm:h-14 ring-4 shadow-sm transition-all duration-500 ease-out group-hover:scale-110"
          [ngClass]="{
            'bg-white ring-slate-200': themeService.theme() === 'light',
            'bg-slate-700 ring-slate-500': themeService.theme() === 'dark'
          }" tabindex="0">
          <i class="relative text-lg sm:text-xl" [ngClass]="[getIcon(step), getColor(step)]"></i>
        </div>
        <p class="mt-3 text-xs sm:text-sm font-medium transition-all duration-300 max-w-[80px] sm:max-w-none" [ngClass]="{
            'text-slate-500': themeService.theme() === 'light',
            'text-slate-300': themeService.theme() === 'dark'
          }">
          {{ step }}
        </p>
        }

      </div>
      }
    </div>
  </div>
</div>