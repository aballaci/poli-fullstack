# Requirements Document

## Introduction

This feature creates interactive, visually compelling frontend components for displaying and completing language learning exercises in the Angular application. The system provides a main exercise selection view with styled buttons for each exercise type, individual exercise components with drag-and-drop interactions, answer validation, and navigation back to the main exercise view. The components integrate with the existing exercise data generated by the backend exercise generator system.

## Glossary

- **Exercise Component**: An Angular component that displays and handles user interaction for a specific exercise type
- **Exercise Service**: An Angular service that fetches exercise data from the GraphQL API by scenario ID and exercise type
- **Main Exercise View**: The component that displays buttons for all available exercise types and serves as the navigation hub
- **Fill-in-the-Blank Component**: An interactive component where users select the correct word to complete a sentence
- **Matching Pairs Component**: A drag-and-drop component where users match source language sentences with target language translations
- **Sentence Scramble Component**: A drag-and-drop component where users arrange jumbled words into the correct sentence order
- **Swipe Component**: A swipe-based component where users swipe right for correct translations and left for incorrect ones
- **Answer Reveal**: The state after exercise completion where correct answers are displayed to the user
- **Exercise Button**: A styled button in the main exercise view that launches a specific exercise type
- **Session Store**: The Angular store that manages the current scenario and session state
- **Conversation View Component**: The parent component that contains the exercise step in the conversation flow

## Requirements

### Requirement 1

**User Story:** As a language learner, I want to see a visually appealing main exercise view with buttons for each exercise type, so that I can easily choose which exercise to practice

#### Acceptance Criteria

1. THE Main Exercise View SHALL display four exercise type buttons: Fill-in-the-Blank, Matching Pairs, Sentence Scramble, and Swipe
2. THE exercise type buttons SHALL use the application's design system styling consistent with the "Next Step" button style shown in the reference code
3. THE Main Exercise View SHALL retrieve the current scenario ID from the Session Store
4. WHEN a user clicks an exercise type button, THE Main Exercise View SHALL navigate to the corresponding exercise component with the scenario ID
5. THE Main Exercise View SHALL display a loading state while checking exercise availability

### Requirement 2

**User Story:** As a language learner, I want an exercise service that fetches exercise data, so that the exercise components can display the correct content

#### Acceptance Criteria

1. THE Exercise Service SHALL provide a method to fetch exercise data by scenario ID and exercise type
2. THE Exercise Service SHALL call the getExerciseForScenario GraphQL query with the provided scenario ID and exercise type
3. IF the exercise data does not exist for the scenario, THEN THE Exercise Service SHALL return null
4. THE Exercise Service SHALL parse the returned JSON into the appropriate TypeScript interface for each exercise type
5. THE Exercise Service SHALL handle authentication errors and network failures gracefully

### Requirement 3

**User Story:** As a language learner, I want to complete fill-in-the-blank exercises with visual feedback, so that I can practice vocabulary in context

#### Acceptance Criteria

1. THE Fill-in-the-Blank Component SHALL display the sentence with a blank space for the missing word
2. THE Fill-in-the-Blank Component SHALL display four option buttons for the user to select from
3. WHEN a user selects an option, THE Fill-in-the-Blank Component SHALL provide immediate visual feedback indicating if the answer is correct or incorrect
4. AFTER the user completes all fill-in-the-blank exercises, THE Fill-in-the-Blank Component SHALL reveal all correct answers
5. THE Fill-in-the-Blank Component SHALL provide a button to return to the Main Exercise View

### Requirement 4

**User Story:** As a language learner, I want to complete matching pairs exercises using click-based selection, so that I can practice connecting source and target language sentences

#### Acceptance Criteria

1. THE Matching Pairs Component SHALL display source language words in styled cards on the left side and target language words in styled cards on the right side in random order
2. THE Matching Pairs Component SHALL support click-based interaction where the user clicks one word card and then clicks a second word card to create a match
3. WHEN a user creates a correct match, THE Matching Pairs Component SHALL remove both matched cards from the display and preserve the order of remaining cards
4. WHEN a user creates an incorrect match, THE Matching Pairs Component SHALL remove one heart from the hearts display and deselect both cards
5. THE Matching Pairs Component SHALL display four hearts at the top right of the exercise area
6. WHEN all hearts are consumed, THE Matching Pairs Component SHALL mark the exercise as failed and provide a button to retry or return to the Main Exercise View
7. WHEN all word pairs are successfully matched, THE Matching Pairs Component SHALL mark the exercise as complete and provide a button to return to the Main Exercise View

### Requirement 5

**User Story:** As a language learner, I want to complete sentence scramble exercises using drag-and-drop, so that I can practice sentence structure and grammar

#### Acceptance Criteria

1. THE Sentence Scramble Component SHALL display the source language sentence as a reference
2. THE Sentence Scramble Component SHALL display the scrambled target language words as draggable items
3. THE Sentence Scramble Component SHALL provide a drop zone where users can arrange words in order
4. WHEN a user completes arranging all words, THE Sentence Scramble Component SHALL validate the order and provide visual feedback
5. AFTER validation, THE Sentence Scramble Component SHALL reveal the correct word order and provide a button to return to the Main Exercise View

### Requirement 6

**User Story:** As a language learner, I want to complete swipe exercises with touch or mouse gestures, so that I can quickly review vocabulary and phrases

#### Acceptance Criteria

1. THE Swipe Component SHALL display one card at a time with a word or phrase and its potential translation
2. THE Swipe Component SHALL support swipe gestures (right for correct, left for incorrect) on touch devices
3. THE Swipe Component SHALL support button clicks or keyboard shortcuts for non-touch interactions
4. WHEN a user swipes or selects an answer, THE Swipe Component SHALL provide immediate visual feedback indicating if the answer was correct
5. AFTER completing all cards, THE Swipe Component SHALL display a summary of correct and incorrect answers and provide a button to return to the Main Exercise View

### Requirement 7

**User Story:** As a language learner, I want to navigate back to the main exercise view from any exercise, so that I can try different exercise types

#### Acceptance Criteria

1. THE Fill-in-the-Blank Component SHALL display a "Back to Exercises" button that navigates to the Main Exercise View
2. THE Matching Pairs Component SHALL display a "Back to Exercises" button that navigates to the Main Exercise View
3. THE Sentence Scramble Component SHALL display a "Back to Exercises" button that navigates to the Main Exercise View
4. THE Swipe Component SHALL display a "Back to Exercises" button that navigates to the Main Exercise View
5. THE navigation back to the Main Exercise View SHALL preserve the current scenario and session state

### Requirement 8

**User Story:** As a language learner, I want to see my progress and completion status for exercises, so that I know which exercises I have completed

#### Acceptance Criteria

1. THE Main Exercise View SHALL display a visual indicator (checkmark or badge) on exercise buttons that have been completed
2. THE Exercise Service SHALL track which exercises have been completed in the current session
3. WHEN a user completes an exercise, THE Exercise Service SHALL mark that exercise type as completed
4. THE completion status SHALL persist during the current session but reset when starting a new scenario
5. THE Main Exercise View SHALL display the total number of completed exercises out of available exercises

### Requirement 9

**User Story:** As a language learner, I want exercises to be responsive and work on mobile devices, so that I can practice on any device

#### Acceptance Criteria

1. THE Main Exercise View SHALL adapt its layout for mobile, tablet, and desktop screen sizes
2. THE drag-and-drop interactions in Matching Pairs and Sentence Scramble components SHALL work with touch gestures on mobile devices
3. THE Swipe Component SHALL prioritize touch gestures on mobile devices and provide button alternatives on desktop
4. THE exercise components SHALL use responsive typography and spacing that adapts to screen size
5. THE exercise components SHALL maintain usability and readability on screens as small as 320px wide

### Requirement 10

**User Story:** As a language learner, I want exercises to handle missing or incomplete data gracefully, so that I can still use the application even if some exercises fail to generate

#### Acceptance Criteria

1. IF an exercise type has no data for the current scenario, THEN THE Main Exercise View SHALL disable or hide the corresponding exercise button
2. IF an exercise fails to load, THEN THE exercise component SHALL display a user-friendly error message
3. THE error message SHALL provide a button to return to the Main Exercise View
4. THE Main Exercise View SHALL display a message indicating which exercises are available if some are missing
5. THE application SHALL not crash or become unusable if exercise data is incomplete or malformed
